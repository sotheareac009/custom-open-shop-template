document.addEventListener("DOMContentLoaded",function(){var e=function(e,t,n,i){i&&("year"===e&&parseInt(t)>1||"month"===e&&parseInt(t)>12||"week"===e&&parseInt(t)>52||"day"===e&&parseInt(t)>356||!n||parseInt(n)<=0?(i.disabled=!0,i.checked=!1,!n||parseInt(n)<=0?i.setAttribute("title",PayPalCommerceGatewayPayPalSubscriptionProducts.i18n.prices_must_be_above_zero):i.setAttribute("title",PayPalCommerceGatewayPayPalSubscriptionProducts.i18n.not_allowed_period_interval)):(i.disabled=!1,i.removeAttribute("title")))},t=function(){jQuery(".wc_input_subscription_period").on("change",function(t){var n=t.target.parentElement.parentElement.parentElement.parentElement.querySelector('input[name="_ppcp_enable_subscription_product"]');if(n){var i,r,a=null===(i=t.target.parentElement.querySelector("select.wc_input_subscription_period_interval"))||void 0===i?void 0:i.value,l=t.target.value,o=null===(r=t.target.parentElement.querySelector("input.wc_input_subscription_price"))||void 0===r?void 0:r.value;e(l,a,o,n)}}),jQuery(".wc_input_subscription_period_interval").on("change",function(t){var n=t.target.parentElement.parentElement.parentElement.parentElement.querySelector('input[name="_ppcp_enable_subscription_product"]');if(n){var i,r,a=t.target.value,l=null===(i=t.target.parentElement.querySelector("select.wc_input_subscription_period"))||void 0===i?void 0:i.value,o=null===(r=t.target.parentElement.querySelector("input.wc_input_subscription_price"))||void 0===r?void 0:r.value;e(l,a,o,n)}}),jQuery(".wc_input_subscription_price").on("change",function(t){var n=t.target.parentElement.parentElement.parentElement.parentElement.querySelector('input[name="_ppcp_enable_subscription_product"]');if(n){var i,r,a=null===(i=t.target.parentElement.querySelector("select.wc_input_subscription_period_interval"))||void 0===i?void 0:i.value,l=null===(r=t.target.parentElement.querySelector("select.wc_input_subscription_period"))||void 0===r?void 0:r.value,o=t.target.value;e(l,a,o,n)}});var t=jQuery("#product-type"),n=jQuery(".wc_input_subscription_price");t.length&&n.length&&["subscription","variable-subscription"].includes(t.val())&&n.trigger("change");for(var i=[PayPalCommerceGatewayPayPalSubscriptionProducts.product_id],r=document.querySelectorAll(".variable_post_id"),a=0;a<r.length;a++)i.push(r[a].value);null==i||i.forEach(function(e){var t=document.getElementById("ppcp_enable_subscription_product-".concat(e));t&&(t.checked&&"yes"===t.value&&function(e){var t=document.querySelector(".woocommerce_variations");if(t)for(var n=t.children,i=0;i<n.length;i++)n[i].querySelector("h3").getElementsByClassName("variable_post_id")[0].value===e&&(n[i].querySelector(".woocommerce_variable_attributes").getElementsByClassName("wc_input_subscription_period_interval")[0].setAttribute("disabled","disabled"),n[i].querySelector(".woocommerce_variable_attributes").getElementsByClassName("wc_input_subscription_period")[0].setAttribute("disabled","disabled"),n[i].querySelector(".woocommerce_variable_attributes").getElementsByClassName("wc_input_subscription_trial_length")[0].setAttribute("disabled","disabled"),n[i].querySelector(".woocommerce_variable_attributes").getElementsByClassName("wc_input_subscription_trial_period")[0].setAttribute("disabled","disabled"),n[i].querySelector(".woocommerce_variable_attributes").getElementsByClassName("wc_input_subscription_length")[0].setAttribute("disabled","disabled"));document.querySelector("#_subscription_period_interval").setAttribute("disabled","disabled"),document.querySelector("#_subscription_period").setAttribute("disabled","disabled"),document.querySelector("._subscription_length_field").style.display="none",document.querySelector("._subscription_trial_length_field").style.display="none",document.querySelector("#_sold_individually").setAttribute("disabled","disabled")}(e),t.addEventListener("click",function(t){var n=document.getElementById("ppcp-enable-subscription-".concat(e)),i=document.getElementById("ppcp_subscription_plan_name_p-".concat(e));!0===t.target.checked?(n&&(n.style.display="none"),i&&(i.style.display="block")):(n&&(n.style.display="block"),i&&(i.style.display="none"))}));var n=document.getElementById("ppcp-unlink-sub-plan-".concat(e));null==n||n.addEventListener("click",function(i){i.preventDefault(),n.disabled=!0;var r=document.getElementById("spinner-unlink-plan-".concat(e));r.style.display="inline-block",fetch(PayPalCommerceGatewayPayPalSubscriptionProducts.ajax.deactivate_plan.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({nonce:PayPalCommerceGatewayPayPalSubscriptionProducts.ajax.deactivate_plan.nonce,plan_id:t.dataset.subsPlan,product_id:e})}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw n.disabled=!1,r.style.display="none",console.error(e),Error(e.data.message);var t=document.getElementById("ppcp-enable-subscription-"+e.data.product_id),i=document.getElementById("pcpp-product-"+e.data.product_id),a=document.getElementById("pcpp-plan-"+e.data.product_id);t.style.display="none",i.style.display="none",a.style.display="none",document.getElementById("ppcp_enable_subscription_product-"+e.data.product_id).disabled=!0,document.getElementById("pcpp-plan-unlinked-"+e.data.product_id).style.display="block",setTimeout(function(){location.reload()},1e3)})})})};t(),jQuery("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){t()})});