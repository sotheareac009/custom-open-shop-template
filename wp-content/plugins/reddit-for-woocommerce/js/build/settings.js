(globalThis.webpackChunkreddit_for_woocommerce=globalThis.webpackChunkreddit_for_woocommerce||[]).push([[472],{4848:(e,t,o)=>{"use strict";t.A=function(e){var t=e.size,o=void 0===t?24:t,r=e.onClick,s=(e.icon,e.className),a=function(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},c=Object.keys(e);for(r=0;r<c.length;r++)o=c[r],0<=t.indexOf(o)||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)o=c[r],0<=t.indexOf(o)||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}(e,c),d=["gridicon","gridicons-checkmark-circle",s,!1,!1,!1].filter(Boolean).join(" ");return n.default.createElement("svg",i({className:d,height:o,width:o,onClick:r},a,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}),n.default.createElement("g",null,n.default.createElement("path",{d:"M11 17.768l-4.884-4.884 1.768-1.768L11 14.232l8.658-8.658A9.98 9.98 0 0012 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10a9.94 9.94 0 00-.966-4.266L11 17.768z"})))};var r,n=(r=o(1609))&&r.__esModule?r:{default:r},c=["size","onClick","icon","className"];function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t,o=1;o<arguments.length;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)}},5964:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>B});var r=o(7723),n=o(6087),c=o(6476),i=o(14),s=o(6701),a=o(3989),d=o(7892),l=o(8242),u=o(6028),m=o(6427),_=o(9457),f=o(7792),g=o(9123);const h="all-accounts",p="reddit-account";var w=o(790);const v={[h]:{title:(0,r.__)("Disconnect all accounts","reddit-for-woocommerce"),confirmButton:(0,r.__)("Disconnect all accounts","reddit-for-woocommerce"),confirmation:(0,r.__)("Yes, I want to disconnect all my accounts.","reddit-for-woocommerce"),contents:[(0,r.__)("I understand that I am disconnecting any WordPress.com account and Reddit account connected to this extension.","reddit-for-woocommerce"),(0,r.__)("Lorem ipsum","reddit-for-woocommerce"),(0,r.__)("Dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.","reddit-for-woocommerce")],eventName:"rfw_disconnect_all_accounts_confirm_button_click"},[p]:{title:(0,r.__)("Disconnect Reddit account","reddit-for-woocommerce"),confirmButton:(0,r.__)("Disconnect Reddit Account","reddit-for-woocommerce"),confirmation:(0,r.__)("Yes, I want to disconnect my Reddit account.","reddit-for-woocommerce"),contents:[(0,r.__)("I understand that I am disconnecting my Reddit account from this WooCommerce extension.","reddit-for-woocommerce"),(0,r.__)("Some configurations for Reddit created through WooCommerce may be lost. This cannot be undone.","reddit-for-woocommerce")],eventName:"rfw_disconnect_reddit_account_confirm_modal_button_click"}};function x({disconnectTarget:e,onRequestClose:t,onDisconnected:o,disconnectAction:c}){const[i,s]=(0,n.useState)(!1),[a,l]=(0,n.useState)(!1),u=(0,g.j)(),{title:p,confirmButton:x,confirmation:b,contents:j,eventName:C}=v[e],y=()=>{a||t()};return(0,w.jsxs)(_.A,{className:"rfw-disconnect-accounts-modal",title:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(f.A,{size:20}),p]}),isDismissible:!a,buttons:[(0,w.jsx)(d.A,{isSecondary:!0,disabled:a,onClick:y,children:(0,r.__)("Never mind","reddit-for-woocommerce")},"1"),(0,w.jsx)(d.A,{isPrimary:!0,isDestructive:!0,loading:a,disabled:!i,onClick:()=>{let r=e===h?u.disconnectAllAccounts:u.disconnectRedditAccount;c&&(r=c),l(!0),r().then(()=>{o(),t()}).catch(()=>{l(!1)})},eventName:C,children:x},"2")],onRequestClose:y,children:[j.map((e,t)=>(0,w.jsx)("p",{children:e},t)),(0,w.jsx)(m.CheckboxControl,{label:b,checked:i,disabled:a,onChange:s})]})}function b(e){return(0,w.jsx)(x,{...e})}function j(){const{hasFinishedResolution:e}=(0,s.A)(),[t,o]=(0,n.useState)(null);return(0,w.jsxs)(w.Fragment,{children:[t&&(0,w.jsx)(b,{onRequestClose:()=>o(null),onDisconnected:()=>{window.location.reload()},disconnectTarget:t}),!e&&(0,w.jsx)(u.A,{}),e&&(0,w.jsx)(a.A,{hideAccountSwitch:!0,children:(0,w.jsx)(l.A.Card.Footer,{children:(0,w.jsx)(d.A,{isDestructive:!0,isLink:!0,onClick:()=>o(p),eventName:"rfw_disconnect_reddit_account_button_click",children:(0,r.__)("Disconnect Reddit account","reddit-for-woocommerce")})})})]})}var C=o(3905),y=o(4856),A=o(873);const{adminNonce:k}=C.WD;var S=o(5640);const{adminNonce:R}=C.WD;var N=o(8258);const O=()=>{const{shouldTriggerExport:e,lastExportTimeStamp:t,exportFileUrl:o,hasFinishedResolution:c}=(0,A.A)(),[i,s]=(0,n.useState)("1"===C.WD.isExportInProgress),[a,l]=(0,n.useState)(C.WD.exportFileUrl||null),[u,_]=(0,n.useState)(C.WD.lastTimestamp||null),f=a&&u,{generateCsv:g}=((e,t)=>{const{createNotice:o}=(0,S.A)();return{generateCsv:(0,n.useCallback)(async()=>{try{const n=await window.jQuery.post(window.ajaxurl,{action:"reddit_for_woocommerce_generate_feed",security:R});if(n.success)return void e();if(!n.success&&"reddit_for_woocommerce_no_products_found"===n.data?.code)return void o("error",(0,r.__)("No products found. Please create products to generate the CSV.","reddit-for-woocommerce"));o("error",(0,r.__)("An error occurred","reddit-for-woocommerce")),t()}catch(e){o("error",(0,r.sprintf)(
// translators: %s: The error message returned from the CSV generation process.
// translators: %s: The error message returned from the CSV generation process.
(0,r.__)("CSV generation failed: %s","reddit-for-woocommerce"),e.message)),t()}},[o,e,t])}})(()=>{s(!0)},()=>{s(!1),l(null),_(null)}),h=()=>{g()},p=(0,n.useCallback)(e=>{const{status:t}=e;switch(t){case"idle":s(!1);break;case"completed":s(!1),l(e.fileUrl),_(e.lastExport);break;case"in-progress":s(!0)}},[]);return((e,t)=>{const o=(0,n.useRef)(null),r=(0,n.useRef)(!1);(0,n.useEffect)(()=>{const n=async()=>{try{const e=await window.jQuery.post(window.ajaxurl,{action:"reddit_for_woocommerce_export_status",security:k});e&&t(e)}catch(e){}};return e&&!o.current&&(r.current||(r.current=!0,n()),o.current=setInterval(n,5e3)),!e&&o.current&&(clearInterval(o.current),o.current=null,r.current=!1),()=>{o.current&&(clearInterval(o.current),o.current=null),r.current=!1}},[e,t])})(i,p),(0,n.useEffect)(()=>{i&&(l(null),_(null))},[i]),(0,n.useEffect)(()=>{e&&c&&g()},[e,c]),(0,n.useEffect)(()=>{t&&_(t),o&&l(o)},[t,o]),(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(y.A,{className:"rfw-product-catalog",title:(0,r.__)("Export Product Catalog","reddit-for-woocommerce"),description:i?(0,r.__)("We’re generating your CSV file… This may take a few seconds.","reddit-for-woocommerce"):u?(0,r.sprintf)(
// translators: %s: The date and time when the product catalog was last exported.
// translators: %s: The date and time when the product catalog was last exported.
(0,r.__)("Last exported on %s.","reddit-for-woocommerce"),u):(0,r.__)("Your product catalog is not synced to Reddit yet. Generate a CSV to manually upload.","reddit-for-woocommerce"),indicator:f?(0,w.jsx)(m.Flex,{spacing:4,wrap:"wrap",children:(0,w.jsx)(d.A,{variant:"secondary",onClick:h,loading:i,eventName:"rfw_regenerate_csv_button_click",eventProps:{context:"settings"},children:(0,r.__)("Regenerate CSV","reddit-for-woocommerce")})}):(0,w.jsx)(d.A,{variant:"secondary",onClick:h,loading:i,eventName:"rfw_generate_csv_button_click",eventProps:{context:"settings"},children:(0,r.__)("Generate CSV","reddit-for-woocommerce")}),actions:(0,w.jsx)(N.A,{}),children:u&&!a&&(0,w.jsx)("div",{className:"rfw-product-catalog__help",children:(0,w.jsx)("p",{children:(0,r.__)('The CSV file may have been deleted and could not be found. Click "Generate CSV" to regenerate a new one.',"reddit-for-woocommerce")})})})})};var E=o(6473);const P=()=>{const{isCapiEnabled:e,hasFinishedResolution:t}=(0,A.A)(),[o,c]=(0,n.useState)(!1),{createNotice:i}=(0,S.A)(),{updateSettings:s}=(0,g.j)(),a=(0,n.useCallback)(async()=>{await s({trackConversions:!e}),(0,E.VF)("rfw_conversion_tracking_toggle",{status:e?"off":"on"})},[s,e]);return t?(0,w.jsx)(y.A,{className:"rfw-settings-track-conversions",title:(0,r.__)("Conversions API","reddit-for-woocommerce"),description:(0,r.__)("Send server-side conversion events to improve attribution.","reddit-for-woocommerce"),actions:(0,w.jsx)("div",{className:"rfw-settings-track-conversions__actions",children:(0,w.jsx)(m.CheckboxControl,{label:(0,r.__)("Enable Conversions API tracking","reddit-for-woocommerce"),checked:e,disabled:o,onChange:async()=>{try{c(!0),await a(),i("success",(0,r.__)("Conversions API Tracking status updated successfully.","reddit-for-woocommerce"))}catch(e){}finally{c(!1)}}})})}):(0,w.jsx)(u.A,{})};var I=o(1968),D=o(3666);const T=()=>{const{isCampaignCreated:e,hasFinishedResolution:t}=(0,A.A)(),o=(0,I.A)();return t?(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(y.A,{className:"rfw-reddit-ads",title:(0,r.__)("Reddit Ads","reddit-for-woocommerce"),description:e?(0,r.__)("Manage your campaigns and view performance reports.","reddit-for-woocommerce"):(0,r.__)("Create a Reddit campaign to promote your products.","reddit-for-woocommerce"),indicator:e?(0,w.jsxs)("div",{className:"rfw-reddit-ads-buttons",children:[(0,w.jsx)(d.A,{variant:"secondary",onClick:()=>{window.open("https://ads.reddit.com/create?flow=advanced&objective=catalogSales&utm_source=partnership&utm_name=woo_commerce","_blank","noopener,noreferrer")},eventName:"rfw_reddit_ads_create_campaign_on_reddit_button_click",eventProps:{context:"settings"},children:(0,r.__)("Create Campaign","reddit-for-woocommerce")}),(0,w.jsx)(d.A,{variant:"secondary",onClick:()=>{window.open("https://ads.reddit.com/dashboard?utm_source=partnership&utm_name=woo_commerce","_blank","noopener,noreferrer")},eventName:"rfw_reddit_go_to_dashboard_button_click",eventProps:{context:"settings"},children:(0,r.__)("Go to Dashboard","reddit-for-woocommerce")})]}):(0,w.jsx)(d.A,{variant:"secondary",onClick:()=>{window.location.href=o+(0,D.xP)()},eventName:"rfw_reddit_ads_create_campaign_button_click",eventProps:{context:"settings"},children:(0,r.__)("Create Campaign","reddit-for-woocommerce")})})}):(0,w.jsx)(u.A,{})};var F=o(1479),M=o(3710),z=o(7679);const B=()=>{(0,i.A)(),(0,M.A)();const{isConnected:e,hasFinishedResolution:t}=(0,s.A)(),o="success"===(0,c.getQuery)()?.onboarding;return(0,n.useEffect)(()=>{!e&&t&&(0,c.getHistory)().replace((0,D.xP)())},[e,t]),(0,w.jsxs)("div",{className:"rfw-settings",children:[o&&(0,w.jsx)(F.A,{}),(0,w.jsx)(l.A,{title:(0,r.__)("Product Catalog","reddit-for-woocommerce"),children:(0,w.jsx)(O,{})}),(0,w.jsx)(l.A,{title:(0,r.__)("Reddit Ads","reddit-for-woocommerce"),children:(0,w.jsx)(T,{})}),(0,w.jsx)(l.A,{title:(0,r.__)("Track Conversions","reddit-for-woocommerce"),description:(0,r.__)("Manage how conversions are tracked on your site.","reddit-for-woocommerce"),children:(0,w.jsx)(P,{})}),(0,w.jsx)(l.A,{title:(0,r.__)("Manage Reddit Connection","reddit-for-woocommerce"),description:(0,r.__)("See your currently connected account or disconnect.","reddit-for-woocommerce"),children:(0,w.jsx)(j,{})}),(0,w.jsx)(l.A,{children:(0,w.jsx)(z.A,{})})]})}},6942:(e,t)=>{var o;!function(){"use strict";var r={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var o=arguments[t];o&&(e=i(e,c(o)))}return e}function c(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var o in e)r.call(e,o)&&e[o]&&(t=i(t,o));return t}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(o=function(){return n}.apply(t,[]))||(e.exports=o)}()},8258:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});var r=o(7723),n=o(6087),c=o(4932),i=o(7892),s=o(8721),a=o(5115),d=o(790);const l=()=>{const{catalog_id:e,catalog_error:t,business_id:o,pixel_id:l,hasFinishedResolution:u}=(0,a.A)(),{createCatalog:m,loading:_,createdCatalogId:f,errorCode:g}=(0,s.A)(),h=g||t;if(!u||e||f||!o||!l)return null;const p=`https://ads.reddit.com/business/${o}/members`,w=(0,d.jsx)("p",{children:(0,n.createInterpolateElement)((0,r.__)("Your account doesn't have the Catalog Manager role, which is required for catalog creation. Please assign it by going to <strong>Your Account › Edit › Member Details & Business Role</strong> › Advanced Role <link>here</link>. Once the role is assigned, please click Create Catalog.","reddit-for-woocommerce"),{strong:(0,d.jsx)("strong",{}),link:(0,d.jsx)("a",{target:"_blank",rel:"external noreferrer noopener",href:p})})}),v=(0,d.jsxs)("p",{children:[(0,n.createInterpolateElement)((0,r.__)("Catalog creation failed because the pixel is already associated with an existing catalog. Please click <strong>Replace Catalog</strong> to delete the existing catalog and create a new one.","reddit-for-woocommerce"),{strong:(0,d.jsx)("strong",{})}),(0,d.jsx)("br",{}),(0,d.jsx)("strong",{children:(0,r.__)("Careful: this can not be undone.","reddit-for-woocommerce")})]}),x=(0,d.jsx)("p",{children:(0,n.createInterpolateElement)((0,r.__)("There was some error creating the Catalog. Please check the <link>logs</link> for more details.","reddit-for-woocommerce"),{link:(0,d.jsx)("a",{target:"_blank",rel:"external noreferrer noopener",href:"/wp-admin/admin.php?page=wc-status&tab=logs"})})}),b="PERMISSION_ERROR"===h,j="CATALOG_ALREADY_EXISTS"===h,C=!b&&!j;return(0,d.jsxs)(c.A,{status:"warning",isDismissible:!1,className:"rfw-reddit-catalog-role-notice",children:[b&&w,j&&v,C&&x,(0,d.jsx)(i.A,{className:"rfw-reddit-catalog-role-notice__create-catalog-button",variant:"secondary",text:j?(0,r.__)("Replace Catalog","reddit-for-woocommerce"):(0,r.__)("Create Catalog","reddit-for-woocommerce"),isBusy:_,isDisabled:_,onClick:()=>{m("CATALOG_ALREADY_EXISTS"===h)}})]})}},9031:(e,t,o)=>{"use strict";t.A=function(e){var t=e.size,o=void 0===t?24:t,r=e.onClick,s=(e.icon,e.className),a=function(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},c=Object.keys(e);for(r=0;r<c.length;r++)o=c[r],0<=t.indexOf(o)||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)o=c[r],0<=t.indexOf(o)||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}(e,c),d=["gridicon","gridicons-notice-outline",s,!!function(e){return 0==e%18}(o)&&"needs-offset",!1,!1].filter(Boolean).join(" ");return n.default.createElement("svg",i({className:d,height:o,width:o,onClick:r},a,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}),n.default.createElement("g",null,n.default.createElement("path",{d:"M12 4c4.411 0 8 3.589 8 8s-3.589 8-8 8-8-3.589-8-8 3.589-8 8-8m0-2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1 13h-2v2h2v-2zm-2-2h2l.5-6h-3l.5 6z"})))};var r,n=(r=o(1609))&&r.__esModule?r:{default:r},c=["size","onClick","icon","className"];function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t,o=1;o<arguments.length;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)}}}]);